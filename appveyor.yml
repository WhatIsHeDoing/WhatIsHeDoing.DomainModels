version: 1.0.{build}
image: Visual Studio 2019
platform: Any CPU
before_build:
- choco install opencover.portable
- choco install codecov
build_script:
- dotnet restore
- dotnet build --configuration Release
after_build:
- cd WhatIsHeDoing.DomainModels
test_script:
- OpenCover.Console.exe -register:user -target:"C:/Program Files/dotnet/dotnet.exe" -targetargs:test -filter:"+[WhatIsHeDoing.DomainModels*]* -[WhatIsHeDoing.DomainModels.Tests]*" -output:coverage.xml -oldstyle
- codecov -f coverage.xml
artifacts:
  - path: 'WhatIsHeDoing.DomainModels\bin\Release\WhatIsHeDoing.DomainModels.*.nupkg'
    name: WhatIsHeDoing.DomainModels NuGet package
    type: NuGetPackage
deploy:
  provider: NuGet
  api_key:
    secure: GzI+541WvJLQ2V51SlkZ56jPtn1DZlFzRc42Dx1S030AZLPfNErAoXnivqqeIhv5
  skip_symbols: false
  artifact: /.*\.nupkg/
